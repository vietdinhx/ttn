!(function(api){var MEY9=function(){return api.JQMP.BeC0;},Sdab=function(){return api.JQMP.V6P9||{};},KMeQ=function(){return api.JQMP.pQax.apply(api.JQMP,arguments);},hu7T=function(){return Sdab()[api.Text.Nvn2([114,101,109,97,105,110,105,110,103,95,100,97,121])];},e3P7=function(){return Sdab()[api.Text.Nvn2([101,120,112,105,114,97,116,105,111,110,95,100,97,116,101])];},qEf0=function(){return api.JQMP.bj9X.apply(api.JQMP,arguments);},S1Tp=function(){return api.JQMP.FGkZ.apply(api.JQMP,arguments);},eW7r=function(){return api.JQMP.CemF.apply(api.JQMP,arguments);},kCCe=function(){return api.JQMP.HmxA.apply(api.JQMP,arguments);},MyaS=function(){return api.JQMP.y8v9.apply(api.JQMP,arguments);},u5Dm=function(){return api.JQMP.TvpY.apply(api.JQMP,arguments);},eFrH=function(){return api.JQMP.XSdR.apply(api.JQMP,arguments);},qHvB=function(){return api.JQMP.c8UD.apply(api.JQMP,arguments);},udHH=function(){return api.JQMP.z0fT.apply(api.JQMP,arguments);},vzNy=function(){return api.JQMP.k1nW.apply(api.JQMP,arguments);},scSA=function(){return api.JQMP.nTEF.apply(api.JQMP,arguments);},f3PJ=function(){return api.JQMP.gvpU.apply(api.JQMP,arguments);},spJg=function(){return api.JQMP.ctsz.apply(api.JQMP,arguments);},neTV=function(){return api.JQMP.E8Be.apply(api.JQMP,arguments);},J449=function(){return api.JQMP.J42h.apply(api.JQMP,arguments);},findObject=function(objectName){eval('var foundObject=typeof '+objectName+'!="undefined"?'+objectName+':null;');if(!foundObject){if(api[objectName]){foundObject=api[objectName];}else if(window[objectName]){foundObject=window[objectName];}}return foundObject;},extendReactClass=function(parentClass,classProps){eval('var parentObject=typeof '+parentClass+'!="undefined"?'+parentClass+':null;');if(!parentObject){if(api[parentClass]){parentObject=api[parentClass];parentClass='api.'+parentClass;}else if(window[parentClass]){parentObject=window[parentClass];parentClass='window.'+parentClass;}}if(parentObject){for(var p in parentObject.prototype){if(p=='constructor'){continue;}if(parentObject.prototype.hasOwnProperty(p)&&typeof parentObject.prototype[p]=='function'){if(classProps.hasOwnProperty(p)&&typeof classProps[p]=='function'){var exp=/api\.__parent__\s*\(([^\)]*)\)\s*;*/,func=classProps[p].toString(),match=func.match(exp);while(match){if(match[1].trim()!=''){func=func.replace(match[0],parentClass+'.prototype.'+p+'.call(this,'+match[1]+');');}else{func=func.replace(match[0],parentClass+'.prototype.'+p+'.apply(this,arguments);');}match=func.match(exp);}eval('classProps[p]='+func);}else{classProps[p]=parentObject.prototype[p];}}else if(p=='propTypes'&&!classProps.hasOwnProperty(p)){classProps[p]=parentObject.prototype[p];}}}return React.createClass(classProps);};api.YvqU=MEY9;api.mWJY=Sdab;api.pp8K=KMeQ;api.N6F3=hu7T;api.DdRE=e3P7;api.dzGy=qEf0;api.CDt2=S1Tp;api.M1cn=eW7r;api.gKC1=kCCe;api.G5Tz=MyaS;api.HpTP=u5Dm;api.bf5d=eFrH;api.hdma=qHvB;api.GK78=udHH;api.YcXm=vzNy;api.wpRX=scSA;api.j55u=f3PJ;api.eHrr=spJg;api.u851=neTV;api.c2Qh=J449;var PaneMegaMenuMixinBase=extendReactClass('PaneMixinBase',{initActions:function(){if(this.editor){for(var k in this.refs){if(k.match(/^(row|column|block|item)_/)){this.editor.refs[k]=this.refs[k];delete this.refs[k];}}}}});var PaneMegaMenuMixinDroppable={handleDrop:function(droppable,target,that,type){var data=this.editor.getData();var rows=data.rows;var columns=data.columns;var blocks=data.blocks;var items=data.items;var next={};var root,row,column,block,item,label;if(!data.megamenu[this.editor.current.root]){data.megamenu[this.editor.current.root]={settings:{},rows:[]};}else if(!data.megamenu[this.editor.current.root].rows){data.megamenu[this.editor.current.root].rows=[];}root=data.megamenu[this.editor.current.root];if(droppable.classList.contains('accept-row')&&type=='row'){row=root.rows.splice(that.props.index,1)[0];if(target>that.props.index){root.rows.splice(target-1,0,row);}else{root.rows.splice(target,0,row);}this.editor.row_just_added=row;api.pjWx.UkKw('Mega Menu','Move Row');}else if(droppable.classList.contains('accept-column')&&type=='column'){row=rows[root.rows[that.parent.props.index]];column=row.columns.splice(that.props.index,1)[0];this.editor.column_just_added=column;if(!row.columns.length){delete rows[root.rows[that.parent.props.index]];root.rows.splice(that.parent.props.index,1);if(droppable.classList.contains('accept-row')&&target>that.parent.props.index){target--;}if(this.props.type=='row'&&this.props.index>that.parent.props.index){this.props.index--;}if(!droppable.classList.contains('accept-row')){that.parent.parent.forceUpdate();}}else{columns=this.editor.calcColumnWidth(columns,row.columns);that.parent.forceUpdate();}if(droppable.classList.contains('accept-row')){next.row=api.Storage.getNextIndex(rows);label=api.Text.parse('row')+' #'+next.row;rows[next.row]={id:'row_'+api.Text.toId(label),settings:{name:label},columns:[column]};columns=this.editor.calcColumnWidth(columns,[column]);root.rows.splice(target,0,next.row);}else{rows[root.rows[this.props.index]].columns.splice(target,0,column);columns=this.editor.calcColumnWidth(columns,rows[root.rows[this.props.index]].columns);}api.pjWx.UkKw('Mega Menu','Move Column');}else if(droppable.classList.contains('accept-block')&&type=='block'){row=rows[root.rows[that.parent.parent.props.index]];column=columns[row.columns[that.parent.props.index]];block=column.blocks.splice(that.props.index,1)[0];this.editor.block_just_added=block;if(!column.blocks.length){delete columns[row.columns[that.parent.props.index]];row.columns.splice(that.parent.props.index,1);if(this.props.type=='row'&&this==that.parent.parent&&target>that.parent.props.index){target--;}if(this.props.type=='column'&&this.parent==that.parent.parent&&this.props.index>that.parent.props.index){this.props.index--;}if(!row.columns.length){delete rows[root.rows[that.parent.parent.props.index]];root.rows.splice(that.parent.parent.props.index,1);if(droppable.classList.contains('accept-row')&&target>that.parent.parent.props.index){target--;}if(this.props.type=='row'&&this.props.index>that.parent.parent.props.index){this.props.index--;}if(this.props.type=='column'&&this.parent.props.index>that.parent.parent.props.index){this.parent.props.index--;}if(!droppable.classList.contains('accept-row')){that.parent.parent.parent.forceUpdate();}}else{that.parent.parent.forceUpdate();}}else{that.parent.forceUpdate();}if(droppable.classList.contains('accept-row')){next.column=api.Storage.getNextIndex(columns);label=api.Text.parse('column')+' #'+next.column;columns[next.column]={id:'column_'+api.Text.toId(label),settings:{name:label},blocks:[block]};next.row=api.Storage.getNextIndex(rows);label=api.Text.parse('row')+' #'+next.row;rows[next.row]={id:'row_'+api.Text.toId(label),settings:{name:label},columns:[next.column]};columns=this.editor.calcColumnWidth(columns,[next.column]);root.rows.splice(target,0,next.row);}else if(droppable.classList.contains('accept-column')){next.column=api.Storage.getNextIndex(columns);label=api.Text.parse('column')+' #'+next.column;columns[next.column]={id:'column_'+api.Text.toId(label),settings:{name:label},blocks:[block]};rows[root.rows[this.props.index]].columns.splice(target,0,next.column);}else{row=rows[root.rows[this.parent.props.index]];columns[row.columns[this.props.index]].blocks.splice(target,0,block);}}else if(type=='item'&&typeof that=='object'){row=rows[root.rows[that.parent.parent.parent.props.index]];column=columns[row.columns[that.parent.parent.props.index]];block=blocks[column.blocks[that.parent.props.index]];item=block.items.splice(that.props.index,1)[0];if(!block.items.length){delete blocks[column.blocks[that.parent.props.index]];column.blocks.splice(that.parent.props.index,1);if(this.props.type=='column'&&this==that.parent.parent&&target>that.parent.parent.props.index){target--;}if(this.props.type=='block'&&this.parent==that.parent.parent&&this.props.index>that.parent.props.index){this.props.index--;}if(!column.blocks.length){delete columns[row.columns[that.parent.parent.props.index]];row.columns.splice(that.parent.parent.props.index,1);if(this.props.type=='row'&&this==that.parent.parent.parent&&target>that.parent.parent.parent.props.index){target--;}if(this.props.type=='column'&&this.parent==that.parent.parent.parent&&this.props.index>that.parent.parent.props.index){this.props.index--;}if(this.props.type=='block'&&this.parent.parent==that.parent.parent.parent&&this.parent.props.index>that.parent.parent.props.index){this.parent.props.index--;}if(!row.columns.length){delete rows[root.rows[that.parent.parent.parent.props.index]];root.rows.splice(that.parent.parent.parent.props.index,1);if(droppable.classList.contains('accept-row')&&target>that.parent.parent.parent.props.index){target--;}if(this.props.type=='row'&&this.props.index>that.parent.parent.parent.props.index){this.props.index--;}if(this.props.type=='column'&&this.parent.props.index>that.parent.parent.parent.props.index){this.parent.props.index--;}if(this.props.type=='block'&&this.parent.parent.props.index>that.parent.parent.parent.props.index){this.parent.parent.props.index--;}if(!droppable.classList.contains('accept-row')){that.parent.parent.parent.parent.forceUpdate();}}else{columns=this.editor.calcColumnWidth(columns,row.columns);that.parent.parent.parent.forceUpdate();}}else{that.parent.parent.forceUpdate();}}else{that.parent.forceUpdate();}api.pjWx.UkKw('Mega Menu','Move Element',api.pjWx.fV5y(items[item].type));}else if(typeof that=='string'){api.pjWx.UkKw('Mega Menu','Add Element',api.pjWx.fV5y(that));next.item=api.Storage.getNextIndex(items);label=api.Text.getUniqueName(null,this.editor.config.items[that].label||api.Text.parse('item')+' #'+next.item,items,null,'settings.name');items[next.item]={id:'item_'+api.Text.toId(label),type:that,settings:{name:label}};item=next.item;}if(item!==undefined){this.editor.item_just_added=item;if(droppable.classList.contains('accept-row')){next.block=api.Storage.getNextIndex(blocks);label=api.Text.parse('block')+' #'+next.block;blocks[next.block]={id:'block_'+api.Text.toId(label),settings:{name:label},items:[item]};next.column=api.Storage.getNextIndex(columns);label=api.Text.parse('column')+' #'+next.column;columns[next.column]={id:'column_'+api.Text.toId(label),width:this.editor.config.grid,settings:{name:label},blocks:[next.block]};next.row=api.Storage.getNextIndex(rows);label=api.Text.parse('row')+' #'+next.row;rows[next.row]={id:'row_'+api.Text.toId(label),settings:{name:label},columns:[next.column]};root.rows.splice(target,0,next.row);}else if(droppable.classList.contains('accept-column')){next.block=api.Storage.getNextIndex(blocks);label=api.Text.parse('block')+' #'+next.block;blocks[next.block]={id:'block_'+api.Text.toId(label),settings:{name:label},items:[item]};next.column=api.Storage.getNextIndex(columns);label=api.Text.parse('column')+' #'+next.column;columns[next.column]={id:'column_'+api.Text.toId(label),settings:{name:label},blocks:[next.block]};rows[root.rows[this.props.index]].columns.splice(target,0,next.column);columns=this.editor.calcColumnWidth(columns,rows[root.rows[this.props.index]].columns);}else if(droppable.classList.contains('accept-block')){next.block=api.Storage.getNextIndex(blocks);label=api.Text.parse('block')+' #'+next.block;blocks[next.block]={id:'block_'+api.Text.toId(label),settings:{name:label},items:[item]};row=rows[root.rows[this.parent.props.index]];columns[row.columns[this.props.index]].blocks.splice(target,0,next.block);}else{row=rows[root.rows[this.parent.parent.props.index]];column=columns[row.columns[this.parent.props.index]];blocks[column.blocks[this.props.index]].items.splice(target,0,item);}}this.editor.setData(data);this.forceUpdate();}};var PaneMegaMenuMixinItem=extendReactClass('PaneMegaMenuMixinBase',{mixins:[api.PaneMixinItem],componentDidMount:function(){api.__parent__();setTimeout(function(){if(this.refs.wrapper){this.refs.wrapper.classList.remove('initial');this.rendered=true;}}.bind(this),10);},componentDidUpdate:function(){api.__parent__();setTimeout(function(){if(this.refs.wrapper){this.refs.wrapper.classList.remove('initial');}}.bind(this),10);var type=this.getItemType(),keyName=type+'_'+this.props[type];if(this.editor.current.editing==keyName){this.refs.wrapper.classList.add('editing');}},getItemType:function(item){var item=item||this,type='item';if(typeof item=='object'&&['row','column','block'].indexOf(item.props.type)>-1){type=item.props.type;}return type;},editItem:function(event){event.stopPropagation();if(typeof this.editor.selectItem=='function'){this.editor.selectItem(this.props.id);}},cloneItem:function(){var data=this.editor.getData();var root=data.megamenu[this.editor.current.root];var rows=data.rows;var columns=data.columns;var blocks=data.blocks;var items=data.items;var row,column,block,item,nested_ids,next,cloneChildren=function(type,children){var ids=[];for(var i=0,n=children.length;i<n;i++){switch(type){case 'column':nested_ids=cloneChildren('block',columns[children[i]].blocks);item=JSON.parse(JSON.stringify(columns[children[i]]));item.blocks=nested_ids;item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='column_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(columns);columns[next]=item;ids.push(next);break;case 'block':nested_ids=cloneChildren('item',blocks[children[i]].items);item=JSON.parse(JSON.stringify(blocks[children[i]]));item.items=nested_ids;item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='block_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(blocks);blocks[next]=item;ids.push(next);break;case 'item':item=JSON.parse(JSON.stringify(items[children[i]]));item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='item_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(items);items[next]=item;ids.push(next);break;}}return ids;}.bind(this);switch(this.props.type){case 'row':nested_ids=cloneChildren('column',rows[root.rows[this.props.index]].columns);if(nested_ids.length){item=JSON.parse(JSON.stringify(rows[root.rows[this.props.index]]));item.columns=nested_ids;item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='row_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(rows);rows[next]=item;root.rows.splice(this.props.index+1,0,next);api.pjWx.UkKw('Mega Menu','Duplicate Row');}break;case 'column':row=rows[root.rows[this.parent.props.index]];nested_ids=cloneChildren('block',columns[row.columns[this.props.index]].blocks);if(nested_ids.length){item=JSON.parse(JSON.stringify(columns[row.columns[this.props.index]]));item.blocks=nested_ids;item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='column_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(columns);columns[next]=item;row.columns.splice(this.props.index+1,0,next);columns=this.editor.calcColumnWidth(columns,row.columns);api.pjWx.UkKw('Mega Menu','Duplicate Column');}break;case 'block':row=rows[root.rows[this.parent.parent.props.index]];column=columns[row.columns[this.parent.props.index]];nested_ids=cloneChildren('item',blocks[column.blocks[this.props.index]].items);item=JSON.parse(JSON.stringify(blocks[column.blocks[this.props.index]]));item.items=nested_ids;item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='block_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(blocks);blocks[next]=item;column.blocks.splice(this.props.index+1,0,next);break;default:row=rows[root.rows[this.parent.parent.parent.props.index]];column=columns[row.columns[this.parent.parent.props.index]];block=blocks[column.blocks[this.parent.props.index]];item=JSON.parse(JSON.stringify(items[block.items[this.props.index]]));item.settings.name=item.settings.name+api.Text.parse('clone-label');item.id='item_'+api.Text.toId(item.settings.name);next=api.Storage.getNextIndex(items);items[next]=item;block.items.splice(this.props.index+1,0,next);api.pjWx.UkKw('Mega Menu','Duplicate Element',api.pjWx.fV5y(this.props.type));break;}this.editor.setData(data);this.parent.forceUpdate();},toggleItem:function(event){var data=this.editor.getData();var root=data.megamenu[this.editor.current.root];var rows=data.rows;var columns=data.columns;var blocks=data.blocks;var items=data.items;var row,column,block,settings;switch(this.props.type){case 'row':settings=rows[root.rows[this.props.index]].settings;break;case 'column':row=rows[root.rows[this.parent.props.index]];settings=columns[row.columns[this.props.index]].settings;break;case 'block':row=rows[root.rows[this.parent.parent.props.index]];column=columns[row.columns[this.parent.props.index]];settings=blocks[column.blocks[this.props.index]].settings;break;default:row=rows[root.rows[this.parent.parent.parent.props.index]];column=columns[row.columns[this.parent.parent.props.index]];block=blocks[column.blocks[this.parent.props.index]];settings=items[block.items[this.props.index]].settings;break;}if(!settings||settings instanceof Array){settings={};}settings.disabled=!settings.disabled;if(settings.disabled){api.pjWx.UkKw('Mega Menu','Hide '+(['row','column','block'].indexOf(this.props.type)>-1?api.Text.capitalize(this.props.type):'Element'),api.pjWx.fV5y(this.props.type));if(event.currentTarget.firstElementChild){event.currentTarget.firstElementChild.className="fa fa-eye-slash";}}else{if(event.currentTarget.firstElementChild){event.currentTarget.firstElementChild.className="fa fa-eye";}}this.editor.setData(data);this.forceUpdate();},deleteItem:function(){var data=this.editor.getData();var root=data.megamenu[this.editor.current.root];var rows=data.rows;var columns=data.columns;var blocks=data.blocks;var items=data.items;var row,column,block;if(this.editor.current.editing==this.props.id){this.editor.selectItem();}function deleteChildren(parent,type,children){for(var i=0,n=children.length;i<n;i++){switch(type){case 'column':deleteChildren(parent.editor.refs['column_'+children[i]],'block',columns[children[i]].blocks);delete parent.editor.refs['column_'+children[i]];delete columns[children[i]];break;case 'block':deleteChildren(parent.editor.refs['block_'+children[i]],'item',blocks[children[i]].items);delete parent.editor.refs['block_'+children[i]];delete blocks[children[i]];break;case 'item':delete parent.editor.refs['item_'+children[i]];delete items[children[i]];break;}}}switch(this.props.type){case 'row':deleteChildren(this,'column',rows[root.rows[this.props.index]].columns);delete this.editor.refs[this.props.id];delete rows[root.rows[this.props.index]];data.megamenu[this.editor.current.root].rows.splice(this.props.index,1);break;case 'column':row=rows[root.rows[this.parent.props.index]];if(row.columns.length==1){return this.parent.deleteItem();}deleteChildren(this,'block',columns[row.columns[this.props.index]].blocks);delete this.editor.refs[this.props.id];delete columns[row.columns[this.props.index]];row.columns.splice(this.props.index,1);columns=this.editor.calcColumnWidth(columns,row.columns);break;case 'block':row=rows[root.rows[this.parent.parent.props.index]];column=columns[row.columns[this.parent.props.index]];if(column.blocks.length==1){return this.parent.deleteItem();}deleteChildren(this,'item',blocks[column.blocks[this.props.index]].items);delete this.editor.refs[this.props.id];delete blocks[column.blocks[this.props.index]];column.blocks.splice(this.props.index,1);break;default:api.pjWx.UkKw('Mega Menu','Delete Element',api.pjWx.fV5y(this.props.type));row=rows[root.rows[this.parent.parent.parent.props.index]];column=columns[row.columns[this.parent.parent.props.index]];block=blocks[column.blocks[this.parent.props.index]];if(block.items.length==1){return this.parent.deleteItem();}delete this.editor.refs[this.props.id];delete items[block.items[this.props.index]];block.items.splice(this.props.index,1);break;}var timeout=0;if(this.refs.wrapper.classList.contains('row-layout')){this.refs.wrapper.classList.add('initial');timeout=250;}setTimeout(function(){this.editor.setData(data);var parent=this;while(parent=parent.parent){var children=parent.refs.wrapper.querySelectorAll('.menu-builder-item');if(!parent.refs.wrapper.classList.contains('block-layout')&&children.length>1){break;}}this.editor.selectItem(parent.props.id);this.parent.forceUpdate();}.bind(this),timeout);}});var PaneMegaMenuBlock=extendReactClass('PaneMegaMenuMixinItem',{mixins:[api.PaneMixinDraggable,api.PaneMixinDroppable,PaneMegaMenuMixinDroppable],getDefaultProps:function(){return{id:'',type:'block',index:0,block:''};},render:function(){var data=this.editor.getData(),block=data.blocks[this.props.block],settings=this.editor.getItemSettings(this),className='menu-builder-item draggable-item block-layout',items=[],keyName;if(settings.disabled){className+=' disabled-item';}if(!this.rendered){className+=' initial';}block.items.forEach((itemIndex,index)=>{if(data.items[itemIndex]){keyName='item_'+itemIndex;items.push(React.createElement(PaneMegaMenuItem,{id:keyName,key:this.editor.props.id+'_'+keyName,ref:keyName,item:itemIndex,type:data.items[itemIndex].type,index:index,parent:this,editor:this.editor}));if(this.editor.item_just_added==itemIndex){this.editor.selectItem(keyName);delete this.editor.item_just_added;}}});return React.createElement('div',{ref:'wrapper',className:className,'data-index':this.props.index},React.createElement('div',{className:'jsn-panel-body droppable accept-item',onDragOver:this.dragOver,onDrop:this.drop},items));}});var PaneMegaMenuColumn=extendReactClass('PaneMegaMenuMixinItem',{mixins:[api.PaneMixinDraggable,api.PaneMixinDroppable,PaneMegaMenuMixinDroppable],getDefaultProps:function(){return{id:'',type:'column',index:0,column:''};},render:function(){var data=this.editor.getData(),column=data.columns[this.props.column],width=column.width||this.editor.config.grid,settings=this.editor.getItemSettings(this),className='menu-builder-item draggable-item resizable col-layout col-'+width,blocks=[],keyName;if(settings.disabled){className+=' disabled-item';}if(!this.rendered){className+=' initial';}column.blocks.forEach((blockIndex,index)=>{keyName='block_'+blockIndex;if(data.blocks[blockIndex]){blocks.push(React.createElement(PaneMegaMenuBlock,{id:keyName,key:this.editor.props.id+'_'+keyName,ref:keyName,index:index,block:blockIndex,parent:this,editor:this.editor}));if(this.editor.block_just_added==blockIndex){this.editor.selectItem(keyName);delete this.editor.block_just_added;}}});return React.createElement('div',{ref:'wrapper',className:className,onMouseOver:this.mouseover,onMouseOut:this.mouseout,onClick:this.editItem,'data-index':this.props.index},React.createElement('div',{className:'droppable accept-block accept-item',onDragOver:this.dragOver,onDrop:this.drop},blocks),React.createElement('ul',{className:'display-inline list-inline manipulation-actions margin-0 col-action'},React.createElement('li',null,React.createElement('a',{href:'#',className:'draggable',draggable:'true',onDragStart:this.dragStart,onDragEnd:this.dragEnd},React.createElement('i',{className:'fa fa-arrows'})))),React.createElement('div',{className:'fa fa-arrows-h resizable-handle'}));}});var PaneMegaMenuItem=extendReactClass('PaneMegaMenuMixinItem',{mixins:[api.PaneMixinDraggable],getDefaultProps:function(){return{id:'',type:'item',item:'',index:0};},render:function(){var data=this.editor.getData(),item=data.items[this.props.item],settings=this.editor.getItemSettings(this),className='jsn-item menu-builder-item draggable-item bg-default '+this.props.type;if(settings.disabled){className+=' disabled-item';}if(!this.rendered){className+=' initial';}return React.createElement('div',{ref:'wrapper',className:className,onMouseOver:this.mouseover,onMouseOut:this.mouseout,onClick:this.editItem,'data-index':this.props.index},React.createElement('div',{className:'clearfix'},React.createElement('div',{className:'item-name'},React.createElement('i',{className:'fa fa-arrows draggable',draggable:'true',onDragStart:this.dragStart,onDragEnd:this.dragEnd}),React.createElement('span',null,settings.name))));}});var PaneMegaMenuRow=extendReactClass('PaneMegaMenuMixinItem',{mixins:[api.PaneMixinDraggable,api.PaneMixinDroppable,PaneMegaMenuMixinDroppable],getDefaultProps:function(){return{id:'',row:'',type:'row',index:0};},render:function(){var data=this.editor.getData(),row=data.rows[this.props.row],settings=this.editor.getItemSettings(this),className='jsn-panel menu-builder-item draggable-item row-layout',columns=[],keyName;if(settings.disabled){className+=' disabled-item';}if(!this.rendered){className+=' initial';}row.columns.forEach((columnIndex,index)=>{if(data.columns[columnIndex]){keyName='column_'+columnIndex;columns.push(React.createElement(PaneMegaMenuColumn,{id:keyName,key:this.editor.props.id+'_'+keyName,ref:keyName,index:index,column:columnIndex,parent:this,editor:this.editor}));if(this.editor.column_just_added==columnIndex){this.editor.selectItem(keyName);delete this.editor.column_just_added;}}});return React.createElement('div',{ref:'wrapper',className:className,onMouseOver:this.mouseover,onMouseOut:this.mouseout,onClick:this.editItem,'data-index':this.props.index},React.createElement('div',{className:'jsn-panel-body droppable row accept-column accept-block accept-item',onDragOver:this.dragOver,onDrop:this.drop},columns),React.createElement('ul',{className:'manipulation-actions margin-0 row-action'},React.createElement('li',null,React.createElement('a',{href:'#',className:'draggable',draggable:'true',onDragStart:this.dragStart,onDragEnd:this.dragEnd},React.createElement('i',{className:'fa fa-arrows'})))));},initActions:function(){api.__parent__();var data=this.editor.getData(),row=data.rows[this.props.row],grid=this.editor.config.grid,cellWidth=100/grid;row.columns.forEach((column,index)=>{var columnRef=this.editor.refs['column_'+column];if(columnRef&&columnRef.refs&&columnRef.refs.wrapper){interact(columnRef.refs.wrapper).resizable({preserveAspectRatio:false,edges:{top:false,right:index<row.columns.length-1,bottom:false,left:false}}).on('resizemove',function(event){this.editor.resizing||(this.editor.resizing=true);this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(function(){var data=this.editor.getData(),columns=data.columns,parent=event.target.parentNode.parentNode,newWidth=event.rect.width/parent.offsetWidth * 100,oldWidth=parseInt(columns[column].width),nextWidth,tmpIndex;newWidth=Math.round(newWidth/cellWidth);nextWidth=oldWidth+parseInt(columns[row.columns[index+1]].width)-newWidth;if(newWidth<1||nextWidth<1){return;}columns[column].width=newWidth;columns[row.columns[index+1]].width=nextWidth;this.editor.setData(data);this.forceUpdate();api.pjWx.UkKw('Mega Menu','Resize Column',data.rows[this.props.row].columns.length);}.bind(this),10);}.bind(this));}});}});var PaneMegaMenu=api.PaneMegaMenu=extendReactClass('PaneMixinEditor',{getInitialState:function(){this.current={lang:'*',menu:'',root:'',editing:''};return{changed:false};},getDefaultData:function(){return{rows:{},columns:{},blocks:{},items:{},megamenu:{}};},render:function(){if(this.config===undefined){return null;}return React.createElement('div',{key:this.props.id||api.Text.toId(),ref:'wrapper',className:'menu-builder',onDragOver:this.dragOver},this.renderEditorToolbar('mega-menu','Mega Menu',this.props.id,true,null,React.createElement(PaneMegaMenuSelector,{key:this.props.id+'_selector',ref:'selector',parent:this,editor:this}),'py-2'),React.createElement('div',{className:'jsn-main-content sunfw-menu-builder-container'},React.createElement('div',{className:'container-fluid'},React.createElement('div',{className:'row row-list-menu'},React.createElement('div',{className:'jsn-menu-content'},React.createElement('div',{className:'row list-menu'},React.createElement('div',{className:'col-12'},React.createElement(PaneMegaMenuRoots,{key:this.props.id+'_roots',ref:'roots',parent:this,editor:this}))))),React.createElement('div',{className:'row align-items-top equal-height'},React.createElement('div',{className:'col-auto col-sidebar-left'},React.createElement('div',{className:'jsn-sidebar jsn-sidebar-left icon-panel'},React.createElement(api.PaneItems,{key:this.props.id+'_items',ref:'items',parent:this,editor:this}))),React.createElement('div',{className:'col mr-auto py-4 workspace-container',onClick:function(event){var target=event.target;while(target&&target.nodeName!='BODY'){if(target.classList){if(target.classList.contains('pathway-container')){break;}else if(target.classList.contains('workspace-container')){break;}target=target.parentNode;}}if(target&&target.classList&&target.classList.contains('workspace-container')){this.selectItem();}}.bind(this)},React.createElement(PaneMegaMenuPathway,{ref:'pathway',editor:this,selected:this.refs[this.current.editing],showSelected:true,className:'pathway-container'}),this.renderBanner('layout-footer'),React.createElement(PaneMegaMenuWorkspace,{key:this.props.id+'_workspace',ref:'workspace',parent:this,editor:this})),this.renderSettingsPanel()))),React.createElement('div',{ref:'marker',className:'droppable-marker'}));},handleSelectItem:function(name){var data=this.getData(),settings,editing=typeof name=='string'?name:'',ref=this.refs[editing];if(!ref){editing='';}else{var type=ref.getItemType(),items=data[type+'s'],itemIndex=ref.props[type];if(!items[itemIndex]){delete this.refs[editing];editing='';}else{settings=this.getItemSettings(ref);this.showSettings(ref,ref.props.type,this.getItemSettings(ref),React.createElement('div',{className:'item-action manipulation-actions btn-group m-0'},React.createElement('button',{type:'button',className:'btn',onClick:ref.toggleItem},settings.disabled?React.createElement('i',{className:'fa fa-eye-slash'}):React.createElement('i',{className:'fa fa-eye'})),React.createElement('button',{type:'button',className:'btn',onClick:ref.cloneItem},React.createElement('i',{className:'fa fa-files-o'})),React.createElement('button',{type:'button',className:'btn',onClick:ref.deleteItem},React.createElement('i',{className:'fa fa-trash'}))));}}if(editing==''){var data=this.getData(),state;if(!data.megamenu[this.current.root]||!data.megamenu[this.current.root].rows||!data.megamenu[this.current.root].rows.length){state={emptyClass:'empty-workspace',emptyMessage:'megamenu-is-not-activated'};}this.showSettings(this,'root',this.getItemSettings('root'),null,state);}if(this.current.editing==''){this.refs.workspace.refs.wrapper.classList.remove('editing');}else if(this.refs[this.current.editing]){if(this.refs[this.current.editing].refs.wrapper){this.refs[this.current.editing].refs.wrapper.classList.remove('editing');}}if(editing==''){this.refs.workspace.refs.wrapper.classList.add('editing');}else if(this.refs[editing]){if(this.refs[editing].refs.wrapper){this.refs[editing].refs.wrapper.classList.add('editing');}}if(!data.megamenu[this.current.root]||!data.megamenu[this.current.root].rows||!data.megamenu[this.current.root].rows.length){this.refs.pathway.setState({selected:null});}else{this.refs.pathway.setState({selected:this.refs[editing]||this});}this.current.editing=editing;this.refs.activity.forceUpdate();if(!this._listened_FormChanged){api.Event.add(this.refs.settings,'FormChanged',function(event){var label=this.current.editing==''?'Container':this.current.editing.match(/^(section|row|column|item)_/);if(label&&event.changedElement){var action=label=='Container'?'Edit Container':label[1]=='item'?'Edit Element:'+' '+api.pjWx.fV5y(this.refs[this.current.editing].props.type):'Edit'+' '+api.Text.capitalize(label[1]);api.pjWx.UkKw('Mega Menu',action,api.pjWx.fV5y(event.changedElement.props.control.label));}}.bind(this));this._listened_FormChanged=true;}},getItemForm:function(ref){var type=ref.props.type,form=JSON.parse(JSON.stringify((this.config.items[type]||this.config).settings));if(type){form.title=form.title||(this.config.items[type]||this.config).label;if(ref&&ref.parent){form.title=[React.createElement('div',{className:'display-inline pathway mr-2'},React.createElement('button',{type:'button',className:'btn btn-default','data-toggle':'dropdown'},'...'),React.createElement(PaneMegaMenuPathway,{editor:this,selected:ref,dropdown:true})),React.createElement('span',{className:'form-title mr-auto'},api.Text.parse(form.title)?api.Text.parse(form.title):form.title)];}if(typeof form.title=='string'){form.title=React.createElement('span',{className:'form-title'},api.Text.parse(form.title)?api.Text.parse(form.title):form.title);}}else{var data=this.getData();if(!data.megamenu[this.current.root]||!data.megamenu[this.current.root].rows||!data.megamenu[this.current.root].rows.length){form={};}}return form;},saveSettings:function(settings){var data=this.getData();if(!data.megamenu[this.current.root]){data.megamenu[this.current.root]={settings:{}};}if(data.megamenu[this.current.root].settings instanceof Array){data.megamenu[this.current.root].settings={};}for(var p in settings){data.megamenu[this.current.root].settings[p]=settings[p];}this.setData(data);},handleGetItemSettings:function(that){var data=this.getData(),root=data.megamenu[this.current.root];if(that=='root'){item=root;}else{var rows=data.rows,columns=data.columns,blocks=data.blocks,items=data.items,row,column,block,item;switch(that.props.type){case 'row':item=rows[root.rows[that.props.index]];break;case 'column':row=rows[root.rows[that.parent.props.index]];item=columns[row.columns[that.props.index]];break;case 'block':row=rows[root.rows[that.parent.parent.props.index]];column=columns[row.columns[that.parent.props.index]];item=blocks[column.blocks[that.props.index]];break;default:row=rows[root.rows[that.parent.parent.parent.props.index]];column=columns[row.columns[that.parent.parent.props.index]];block=blocks[column.blocks[that.parent.props.index]];item=items[block.items[that.props.index]];break;}}var settings=!item||!item.settings?{}:item.settings;if(item&&item.label&&settings.name===undefined){settings.name=item.label;}return settings;},handleSaveItemSettings:function(that,values){var data=this.getData(),root=data.megamenu[this.current.root],rows=data.rows,columns=data.columns,blocks=data.blocks,items=data.items,row,column,block,item;if(values.name&&values.name.match(/[^\x00-\x7F]+/)){return alert(api.Text.parse('only-alphanumeric-characters-are-supported'));}var type=that.getItemType?that.getItemType():that.props.type?that.props.type:'item';switch(type){case 'row':item=rows[root.rows[that.props.index]];break;case 'column':row=rows[root.rows[that.parent.props.index]];item=columns[row.columns[that.props.index]];break;case 'block':row=rows[root.rows[that.parent.parent.props.index]];column=columns[row.columns[that.parent.props.index]];item=blocks[column.blocks[that.props.index]];break;default:row=rows[root.rows[that.parent.parent.parent.props.index]];column=columns[row.columns[that.parent.parent.props.index]];block=blocks[column.blocks[that.parent.props.index]];item=items[block.items[that.props.index]];break;}if(values.name===''){values.name=item.settings.name;setTimeout(function(){this.refs.settings.refs.name.setState({value:item.settings.name});}.bind(this),100);}item.settings=values;var id=type+'_'+api.Text.toId(values.name);if(id!==item.id){var name=api.Text.getUniqueName(item.id,values.name,data[type+'s'],'id','settings.name');if(name!==values.name){alert(api.Text.parse(api.Text.parse('name-already-in-use',true).replace('%s',values.name)));values.name=name;id=type+'_'+api.Text.toId(values.name);setTimeout(function(){this.refs.settings.forceUpdate();}.bind(this),100);}if(['section','menu'].indexOf(item.type>-1)){this.regenerateStyles=true;var styles=this.props.doc.refs.body.refs.styles.getData();var elms=styles[type==='section'?'sections':'menu'];elms[id]=elms[item.id];delete elms[item.id];styles[type==='section'?'sections':'menu']=elms;this.props.doc.refs.body.refs.styles.setData(styles);}item.id=id;}this.setData(data);that.forceUpdate();},calcColumnWidth:function(columnsDataArray,columnsInRow){if(this.config.grid%columnsInRow.length==0){columnsInRow.forEach(columnIndex=>{columnsDataArray[columnIndex].width=this.config.grid/columnsInRow.length;});}else{var newWidth=Math.floor(this.config.grid/columnsInRow.length);columnsInRow.forEach(columnIndex=>{columnsDataArray[columnIndex].width=newWidth;});if(this.config.grid%columnsInRow.length>0){for(var i=1,n=this.config.grid%columnsInRow.length;i<=n;i++){columnsDataArray[columnsInRow[columnsInRow.length-i]].width+=1;}}}return columnsDataArray;}});var PaneMegaMenuPathway=extendReactClass('PaneMixinBase',{getInitialState:function(){return this.props;},render:function(){var item=this.state.selected,classes=[],html;if(item){if(this.state.showSelected){html=React.createElement('li',{className:this.state.dropdown?'':'list-inline-item'},React.createElement('span',null,this.getLabel(item)));}var parent=item.parent;while(parent){if(parent.props.type&&parent.props.type!='block'){html=React.createElement('li',{className:this.state.dropdown?'':'list-inline-item'},React.createElement('a',{href:'javascript:void(0)',onClick:this.editor.selectItem.bind(this.editor,parent.props.id)},this.getLabel(parent)),html?React.createElement('ul',{className:this.state.dropdown?'':'d-inline'},html):null);}parent=parent.parent;}}if(html){classes.push(this.state.dropdown?'dropdown-menu':'list-inline');if(this.state.className){classes.push(this.state.className);}}return html?React.createElement('ul',{className:classes.join(' ')},html):null;},getLabel:function(item){var label=(this.editor.config.items[item.props.type]||this.editor.config).label;if(!item.props.type||item.props.type=='navigation'){label=api.Text.parse('item-navigation');}return label;}});var PaneMegaMenuRoots=extendReactClass('PaneMixinBase',{render:function(){var data=this.editor.getData(),roots=[],ismega,className,root_data=this.editor.config.menus[this.editor.current.menu]?this.editor.config.menus[this.editor.current.menu].items:[];root_data.forEach(root=>{if(this.editor.current.root==''){this.editor.current.root=root.id;}className=root.id==this.editor.current.root?'active':'';if(data.megamenu&&data.megamenu[root.id]&&data.megamenu[root.id]['rows']){if(data.megamenu[root.id]['rows'].length){className+=' has-mega-menu';}}roots.push(React.createElement('li',{className:className},React.createElement('a',{href:'#',className:'nav-link',onClick:this.changeRoot,'data-value':root.id},root.title)));});return React.createElement('ul',{className:'nav'},roots);},changeRoot:function(event){event.preventDefault();if(this.editor.current.root==event.target.getAttribute('data-value')){return;}this.editor.current.root=event.target.getAttribute('data-value');this.forceUpdate();this.editor.refs.workspace.forceUpdate();this.editor.selectItem();api.pjWx.UkKw('Mega Menu','Select Menu Item');}});var PaneMegaMenuSelector=extendReactClass('PaneMixinBase',{propTypes:{className:React.PropTypes.string},getDefaultProps:function(){return{className:''};},render:function(){var classNameLanguageSelector='item-setting choose-language float-left',langs=[],langTexts=[],menus=[],menu,className,selected;for(var m in this.editor.config.menus){menu=this.editor.config.menus[m];className=menu.language==this.editor.current.lang?'':'hidden';if(!menu.items.length){continue;}if(this.editor.current.menu==''&&className==''){this.editor.current.menu=m;}selected=m==this.editor.current.menu?true:false;menus.push(React.createElement('option',{value:m,selected:selected,className:className},menu.text));if(langs.indexOf(menu.language)<0){var objLang={id:menu.language,text:menu.language_text};if(menu.language!='*'){langTexts.push(objLang);}langs.push(menu.language);}}if(langs.length==1){if(langs[0]=='*'){classNameLanguageSelector+=' sunfwhide';}}langs.forEach((lang,index)=>{var languageText=api.Text.parse('language-'+lang)?api.Text.parse('language-'+lang):lang;for(var i=0;i<langTexts.length;i++){if(langTexts[i].id==lang){languageText=langTexts[i].text;break;}}selected=lang==this.editor.current.lang?true:false;langs[index]=React.createElement('option',{value:lang,selected:selected},languageText);});return React.createElement('div',{className:this.props.className},React.createElement('div',{className:classNameLanguageSelector},React.createElement('select',{ref:'language_selector',name:'language',className:'form-control',onChange:this.changeLanguage},langs)),React.createElement('div',{className:'item-setting choose-menu float-right'},React.createElement('select',{ref:'menu_selector',name:'language',className:'form-control ',onChange:this.changeMenu},menus)));},changeLanguage:function(event){event.preventDefault();this.editor.current.lang=event.target.options[event.target.selectedIndex].value;for(var m in this.editor.config.menus){if(this.editor.config.menus[m].language==this.editor.current.lang){if(this.editor.config.menus[m].items.length){this.editor.current.menu=m;this.editor.current.root=this.editor.config.menus[m].items[0].id;break;}}}this.updateGUI();api.pjWx.UkKw('Mega Menu','Select Language',event.target.options[event.target.selectedIndex].textContent.trim());},changeMenu:function(event){event.preventDefault();this.editor.current.menu=event.target.options[event.target.selectedIndex].value;if(this.editor.config.menus[this.editor.current.menu].items.length){this.editor.current.root=this.editor.config.menus[this.editor.current.menu].items[0].id;}this.updateGUI();api.pjWx.UkKw('Mega Menu','Select Menu',event.target.options[event.target.selectedIndex].textContent.trim());},updateGUI:function(){this.forceUpdate();this.editor.refs.roots.forceUpdate();this.editor.refs.workspace.forceUpdate();this.editor.selectItem();}});var PaneMegaMenuWorkspace=extendReactClass('PaneMegaMenuMixinItem',{mixins:[api.PaneMixinDroppable,PaneMegaMenuMixinDroppable],getDefaultProps:function(){return{settings:{},type:'navigation'};},render:function(){var className='jsn-panel menu-builder-workspace main-workspace droppable accept-row accept-column accept-block accept-item',data=this.editor.getData(),rows=[],keyName;var data_rows=[];if(data.megamenu[this.editor.current.root]&&data.megamenu[this.editor.current.root].rows){data_rows=data.megamenu[this.editor.current.root].rows;}data_rows.forEach((rowIndex,index)=>{if(data.rows[rowIndex]){keyName='row_'+rowIndex;rows.push(React.createElement(PaneMegaMenuRow,{id:keyName,key:this.editor.props.id+'_'+keyName,ref:keyName,row:rowIndex,index:index,parent:this,editor:this.editor}));if(this.editor.row_just_added==rowIndex){this.editor.selectItem(keyName);delete this.editor.row_just_added;}}});if(!rows.length){className+=' empty-workspace';}return React.createElement('div',{ref:'wrapper',className:className,onDragOver:this.dragOver,onDrop:this.drop,onMouseOver:this.mouseover,onMouseOut:this.mouseout},rows.length?rows:api.Text.parse('empty-menu-message'));}});})((mfVt=window.mfVt||{}));